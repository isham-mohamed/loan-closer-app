<div class="container">
  <app-calculator-header />

  <div class="main-content">
    <div class="form-panel">
      <app-loan-form
        [principalDisplay]="principalDisplay"
        [annualRate]="annualRate"
        [tenureYears]="tenureYears"
        [tenureMonths]="tenureMonths"
        [startDate]="startDate"
        [extraPaymentDisplay]="extraPaymentDisplay"
        [hasExtraPayment]="!!extraPayment"
        (principalChange)="onPrincipalChange($event)"
        (annualRateChange)="annualRate = $event"
        (tenureYearsChange)="tenureYears = $event"
        (tenureMonthsChange)="tenureMonths = $event"
        (startDateChange)="startDate = $event"
        (extraPaymentChange)="onExtraPaymentChange($event)"
        (calculate)="calculate()"
        (reset)="resetAll()"
      />

      @if (emi > 0) {
        <app-loan-summary
          [emi]="emi"
          [totalInterest]="totalInterest"
          [totalPayable]="totalPayable"
        />
      }
    </div>

    @if (schedule.length) {
      <app-amortization-table [schedule]="schedule" />
    }
  </div>
</div>

<app-extra-payment-strategy-dialog
  [visible]="showStrategyDialog"
  [extraPaymentAmount]="extraPayment ?? 0"
  (strategySelected)="onStrategySelected($event)"
  (closed)="closeStrategyDialog()"
/>

@if (comparison && !showStrategyDialog) {
  <app-extra-payment-comparison
    [comparison]="comparison"
    (close)="clearComparison()"
  />
}
